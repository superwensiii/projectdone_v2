;/*FB_PKG_DELIM*/

__d("LSOptimisticContributeToTextPrompt",["LSLocalApplyOptimisticMessageV2","LSLocalApplyOptimisticRollCallContribution"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.createArray(),d[1]=new c.Map(),d[1].set("snippet_has_emoji",void 0),d[1].set("sticker_id",void 0),d[1].set("sticker_alt_text",void 0),d[1].set("hot_emoji_size",void 0),d[1].set("external_attachment_url",void 0),d[1].set("attribution_app_id",void 0),d[1].set("source",c.i64.cast([0,0])),d[1].set("platform_ref",void 0),d[1].set("platform_token",void 0),d[1].set("reply_source_id",void 0),d[1].set("reply_source_type",void 0),d[1].set("reply_source_type_v2",void 0),d[1].set("mention_data",void 0),d[1].set("mark_read",void 0),d[1].set("calculate_denormalizations",void 0),d[1].set("optimistic_attachment_preview",void 0),d[1].set("initiating_app_id",void 0),d[1].set("initiating_source",void 0),d[1].set("power_up_style",c.i64.cast([0,0])),d[1].set("data_trace_id",void 0),d[1].set("attachments",d[0]),d[1].set("should_copy_attachments",!1),d[1].set("magic_words_data",void 0),d[1].set("local_data_id",void 0),d[1].set("reply_type",void 0),d[1].set("dety_params",void 0),d[1].set("product_type","roll_call"),d[1].set("product_fbid",a[2]),d[1].set("product_attribution",a[3]),c.storedProcedure(b("LSLocalApplyOptimisticMessageV2"),a[1],a[0],c.i64.cast([0,18]),a[4],a[4],d[1],void 0).then(function(a){return a=a,d[2]=a[0],d[3]=a[1],a})},function(e){return d[4]=c.createArray(),c.storedProcedure(b("LSLocalApplyOptimisticRollCallContribution"),a[0],a[2],d[4],d[2],d[3],a[3],c.i64.cast([0,1]),a[4])}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxOptimisticContributeToTextPromptStoredProcedure";e.exports=a}),null);
__d("LSOptimisticContributeToTextPromptStoredProcedure",["LSOptimisticContributeToTextPrompt","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.senderId;d[2]=b.promptId;d[3]=b.productAttribution;d[4]=b.text;return c("LSOptimisticContributeToTextPrompt").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("LSOptimisticCreateRollCall",["LSCreateOfflineThreadingID","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSCreateOfflineThreadingID"),d[0]).then(function(a){return a=a,d[1]=a[0],a})},function(b){return c.forEach(c.filter(c.db.table(250).fetch([[[d[1],a[0]]]]),function(b){return c.i64.eq(b.rollCallId,d[1])&&c.i64.eq(b.threadKey,a[0])&&c.i64.lt(b.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(250).add({rollCallId:d[1],threadKey:a[0],rollCallPrompt:a[1],expiryTimestampSec:c.i64.cast([0,0]),isBlurred:!1,authorityLevel:c.i64.cast([0,20]),offlineThreadingId:d[1],canViewWithoutContributing:!1})},function(e){return d[2]=new c.Map(),d[2].set("thread_key",a[0]),d[2].set("prompt",a[1]),d[2].set("offline_threading_id",d[1]),d[2].set("prompt_type",a[2]),d[3]=d[2].get("thread_key"),d[2],d[4]=c.toJSON(d[2]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[3]),c.i64.cast([0,607]),d[4],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return a=[d[1],d[0]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxOptimisticCreateRollCallStoredProcedure";e.exports=a}),null);
__d("LSOptimisticCreateRollCallStoredProcedure",["LSOptimisticCreateRollCall","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.prompt;d[2]=b.promptType;return c("LSOptimisticCreateRollCall").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MWChatPromptFlyoutFrontCard.react",["fbt","BaseTextArea.react","CometPlaceholder.react","MWChatPollFacepile.react","MWPActor.react","ReQL","ReQLSuspense","react","stylex","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=k||d("react"),m={frontCard:{backgroundColor:"x9bbmet",borderTopStartRadius:"xfh8nwu",borderTopEndRadius:"xoqspk4",borderBottomEndRadius:"x12v9rci",borderBottomStartRadius:"x138vmkv",boxShadow:"xi1c1fh",display:"x78zum5",flexDirection:"xdt5ytf",flexGrow:"x1iyjqo2",flexShrink:"x2lah0s",marginTop:"x1gslohp",marginBottom:"x12nagc",minHeight:"x1shn012",position:"x1n2onr6",width:"x6vytul",zIndex:"x1vjfegm",$$css:!0},textarea:{backgroundColor:"x9bbmet",borderTopStyle:"x1ejq31n",borderEndStyle:"xd10rxx",borderBottomStyle:"x1sy0etr",borderStartStyle:"x17r0tee",color:"xzsf02u",display:"x1lliihq",flexGrow:"x1iyjqo2",fontSize:"x6prxxf",fontWeight:"x1xlr1w8",marginTop:"x1xmf6yo",marginEnd:"x1emribx",marginBottom:"x1e56ztr",marginStart:"x1i64zmx",paddingTop:"x1y1aw1k",textAlign:"x2b8uid",$$css:!0}};function n(){var a=(i||(i=c("useReStore")))(),b=d("MWPActor.react").useActor(),e=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(a.tables.contacts).getKeyRange(b).map(function(a){return a.profilePictureUrl})},[a,b],f.id+":72");e=e!=null?[{profile_picture_url:e}]:[];return l.jsx(c("MWChatPollFacepile.react"),{contacts:e,direction:"reversed",gap:"negative",size:"mediumLarge"})}n.displayName=n.name+" [from "+f.id+"]";function a(a){var b=a.onChange,d=a.showFacepile;d=d===void 0?!1:d;var e=a.value;a=a.xstyle;return l.jsxs("div",{className:(j||(j=c("stylex")))(m.frontCard,a),children:[l.jsx(c("BaseTextArea.react"),{"aria-label":h._("__JHASH__M7osj0aoSaL__JHASH__"),maxLength:50,onChange:b,placeholder:h._("__JHASH__4kvNP1szhkx__JHASH__"),suppressFocusRing:!0,unresizable:!0,value:e,xstyle:m.textarea}),d?l.jsx(c("CometPlaceholder.react"),{fallback:null,children:l.jsx("div",{className:"x1gryazu xkrivgy x1l90r2v",children:l.jsx(n,{})})}):null]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("useMWChatPromptSuggestions",["fbt","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||d("react")).useMemo,k=[h._("__JHASH__36BYGlpQtWb__JHASH__"),h._("__JHASH__V-weVECiTjR__JHASH__"),h._("__JHASH__gjLieSQwOUx__JHASH__"),h._("__JHASH__ieK6tq_cgxw__JHASH__"),h._("__JHASH__RhK4ghDrdIN__JHASH__"),h._("__JHASH__g1ZdnaGJN5X__JHASH__"),h._("__JHASH__E_415VXITzl__JHASH__"),h._("__JHASH__eHLXzP2TSOZ__JHASH__"),h._("__JHASH__tZRoYoQR7CH__JHASH__"),h._("__JHASH__aL9VVWwvNE9__JHASH__"),h._("__JHASH__TOM4ZEHVssE__JHASH__"),h._("__JHASH__28C1KLun20l__JHASH__"),h._("__JHASH__AzAym9J7EWA__JHASH__"),h._("__JHASH__uXjDaOT32-5__JHASH__"),h._("__JHASH__QxscZ4lxunq__JHASH__"),h._("__JHASH__qy8iamPbReV__JHASH__"),h._("__JHASH__TXxbFpKeb22__JHASH__"),h._("__JHASH__6gV4NChieWE__JHASH__"),h._("__JHASH__JLk6BM4UvkT__JHASH__"),h._("__JHASH__mwik205YEPp__JHASH__"),h._("__JHASH__8sIVGHbOcnd__JHASH__"),h._("__JHASH__160uCVH-bA5__JHASH__"),h._("__JHASH__X5O2vx4mHSM__JHASH__"),h._("__JHASH__FPtMuola2gP__JHASH__")];function l(a){a=a.slice();for(var b=a.length-1;b>=0;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c];a[c]=d}return a}function a(){return j(function(){return l(k)},[])}g["default"]=a}),226);
__d("MWChatPromptFlyoutSuggestions.react",["FocusGroup.react","MWXPressable.react","MWXScrollableArea.react","MWXText.react","focusScopeQueries","react","useMWChatPromptSuggestions"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j={pressable:{borderTopStartRadius:"xyi19xy",borderTopEndRadius:"x1ccrb07",borderBottomEndRadius:"xtf3nb5",borderBottomStartRadius:"x1pc53ja",marginTop:"xw7yly9",marginBottom:"x1yztbdb",marginStart:"x1i64zmx",marginLeft:null,marginRight:null,marginEnd:"x1emribx",$$css:!0},scrollArea:{maxWidth:"x193iq5w",$$css:!0}};function k(a){var b=a.onPress;a=a.text;return i.jsx(c("MWXPressable.react"),{onPress:b,overlayRadius:"inherit",xstyle:j.pressable,children:i.jsx("div",{className:"x6s0dn4 xx7qk4p xyi19xy x1ccrb07 xtf3nb5 x1pc53ja xwflfxt x78zum5 x2lah0s x1vqgdyp xl56j7k x1kbpmyu x1y1aw1k x1sxyh0 xwib8y2 xurb0ha x2b8uid",children:i.jsx(c("MWXText.react"),{color:"secondary",numberOfLines:2,type:"body4",children:a})})})}k.displayName=k.name+" [from "+f.id+"]";b=d("FocusGroup.react").createFocusGroup(d("focusScopeQueries").tabbableScopeQuery);var l=b[0],m=b[1];function a(a){var b=a.onPressSuggestion;a=c("useMWChatPromptSuggestions")();return i.jsxs(c("MWXScrollableArea.react"),{horizontal:!0,vertical:!1,xstyle:j.scrollArea,children:[i.jsx("div",{className:"x2lah0s x1xc55vz"}),i.jsx(l,{orientation:"horizontal",tabScopeQuery:d("focusScopeQueries").tabbableScopeQuery,wrap:!0,children:a.map(function(a,c){return i.jsx(m,{children:i.jsx(k,{onPress:function(){return b(a)},text:a})},c)})}),i.jsx("div",{className:"x2lah0s x1xc55vz"})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("RollCallContributionType",[],(function(a,b,c,d,e,f){a=Object.freeze({MEDIA:0,TEXT:1,LINK:2});f["default"]=a}),66);
__d("RollCallPromptType",[],(function(a,b,c,d,e,f){a=Object.freeze({MEDIA:0,TEXT:1,LINK:2});f["default"]=a}),66);
__d("MWPromptCreationUtils",["I64","LSAuthorityLevel","LSFactory","LSIntEnum","LSLocalApplyOptimisticMessageWithAttachmentsV2StoredProcedure","LSMessagingThreadAttributionType","LSOptimisticContributeToTextPromptStoredProcedure","LSOptimisticCreateRollCallStoredProcedure","LSShape","LSVec","MWXMAAttachmentSharedStackConstants","MessagingAttachmentType","OfflineThreadingId","Promise","ReQL","RollCallContributionType","RollCallPromptType","XComposerPhotoUploader"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,e,g,k){return new(j||(j=b("Promise")))(function(b,j){a.runInTransaction(function(a){return c("LSOptimisticCreateRollCallStoredProcedure")(c("LSFactory")(a),{prompt:g,promptType:(h||(h=d("LSIntEnum"))).ofNumber(k),threadKey:e})},"readwrite",void 0,void 0,f.id+":49").then(function(e){var f=e[0],g=d("ReQL").fromTableAscending(a.tables.roll_calls).subscribe(function(a,e){if(e.operation==="add"||e.operation==="put"){a=e.value.offlineThreadingId;var h=(i||(i=d("I64"))).to_int32(e.value.authorityLevel)>=c("LSAuthorityLevel").AUTHORITATIVE;h&&a!=null&&(i||(i=d("I64"))).equal(a,f)&&(g(),b(e.value.rollCallId))}})})["catch"](function(a){j(a)})})}function k(a,b,e,g,h){return a.runInTransaction(function(a){return c("LSOptimisticContributeToTextPromptStoredProcedure")(c("LSFactory")(a),{productAttribution:String(c("LSMessagingThreadAttributionType").ROLLCALL),promptId:(i||(i=d("I64"))).to_string(g),senderId:b,text:(a=h)!=null?a:"",threadKey:e})},"readwrite",void 0,void 0,f.id+":91")}function l(a,b,e,g,j,k,l,m){var n,o=d("OfflineThreadingId").createOfflineThreadingID(),p=(n=m==null?void 0:m.startsWith("video/"))!=null?n:!1;return a.runInTransaction(function(a){return c("LSLocalApplyOptimisticMessageWithAttachmentsV2StoredProcedure")(c("LSFactory")(a),{extraSendMessageParams:d("LSShape").ofRecord({attachments:c("LSVec").ofArray([d("LSShape").ofRecord({attachment_fbid:o,attachment_index:(i||(i=d("I64"))).zero,attachment_type:(h||(h=d("LSIntEnum"))).ofNumber(p?c("MessagingAttachmentType").VIDEO:c("MessagingAttachmentType").IMAGE),has_media:!0,has_xma:!0,offline_attachment_id:o,playable_url:p?l:void 0,preview_height:i.of_float(d("MWXMAAttachmentSharedStackConstants").STACK_ITEM_HEIGHT),preview_url:p?void 0:l,preview_url_mime_type:p?void 0:m,preview_width:i.of_float(d("MWXMAAttachmentSharedStackConstants").STACK_ITEM_WIDTH)})]),contribution_type:h.ofNumber(c("RollCallContributionType").MEDIA),product_fbid:i.to_string(j),product_type:"roll_call",source:h.ofNumber(c("LSMessagingThreadAttributionType").ROLLCALL)}),senderId:b,text:k,threadKey:e,threadType:g})},"readwrite",void 0,void 0,f.id+":114").then(function(a){a=a[0];return a})}function e(a,d,e,f,g,h,i,m,n){switch(i){case c("RollCallPromptType").MEDIA:return l(a,d,e,f,g,h,m,n);case c("RollCallPromptType").TEXT:return k(a,d,e,g,h);default:return(j||(j=b("Promise"))).reject("Unsupported type")}}function m(a,b,e,f){var g=d("OfflineThreadingId").createOfflineThreadingID();a=a;a.uploadID=g;var h=new(c("XComposerPhotoUploader"))({onUploadFailure:function(a,b){},onUploadSuccess:function(a,b){},uploadEndpoint:"/messenger/upload_roll_call/"});h.getAsyncFileUploadRequest([a],[g],{data:{message_otid:e,roll_call_id:(i||(i=d("I64"))).to_string(b),thread_id:f}}).send()}g.createAuthoritiativeRollCall=a;g.createOptimisticRollCallMessage=e;g.startRollCallMediaUpload=m}),98);
__d("MWXDialog.react",["MWXColumn.react","MWXColumnItem.react","cr:3020","cr:6827","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var d=a.children,e=a.hasTextOnlyContent;a=babelHelpers.objectWithoutPropertiesLoose(a,["children","hasTextOnlyContent"]);if(b("cr:3020")!=null)return i.jsx(b("cr:3020"),babelHelpers["extends"]({},a,{children:i.jsx(c("MWXColumn.react"),{expanding:!0,paddingHorizontal:16,paddingVertical:16,children:i.jsx(c("MWXColumnItem.react"),{expanding:!0,children:d})})}));return b("cr:6827")!=null?i.jsx(b("cr:6827"),babelHelpers["extends"]({hasTextOnlyContent:e},a,{children:d})):null}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWXDialogFooter.react",["MWXSpinner.react","cr:6993","cr:9720","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var d=a.callToActionGroupDirection,e=a.callToActionGroupWrap,f=a.primaryCallToAction,g=a.secondaryCallToAction;a=babelHelpers.objectWithoutPropertiesLoose(a,["callToActionGroupDirection","callToActionGroupWrap","primaryCallToAction","secondaryCallToAction"]);if(b("cr:9720")!=null){var h;h=(h=f)!=null?h:g;var j=f==null?null:g;if(h==null)return null;var k=h.disabled,l=h.loading,m=babelHelpers.objectWithoutPropertiesLoose(h,["disabled","loading"]),n=l===!0?i.jsx(c("MWXSpinner.react"),{color:"blue",size:24}):void 0;return i.jsx(b("cr:9720"),babelHelpers["extends"]({direction:d,primary:babelHelpers["extends"]({},m,{addOnPrimary:n,disabled:l===!0?!0:k,type:h.type==="destructive"?"fdsOverride_negative":h.type}),secondary:j,wrap:e},a))}return b("cr:6993")!=null?i.jsx(b("cr:6993"),babelHelpers["extends"]({callToActionGroupDirection:d,primaryCallToAction:f,secondaryCallToAction:g},a)):null}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWXDialogHeader.react",["cr:73","cr:7626","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var c=a.title,d=a.withoutDivider;a=babelHelpers.objectWithoutPropertiesLoose(a,["title","withoutDivider"]);if(b("cr:7626")!=null)return i.jsx(b("cr:7626"),babelHelpers["extends"]({text:c},a,{withoutDivider:d}));return b("cr:73")!=null?i.jsx(b("cr:73"),babelHelpers["extends"]({title:c},a)):null}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatPromptDialog.react",["fbt","FBLogger","FocusRegion.react","MWChatPromptFlyoutFrontCard.react","MWChatPromptFlyoutSuggestions.react","MWPActor.react","MWPromptCreationUtils","MWXDialog.react","MWXDialogFooter.react","MWXDialogHeader.react","MWXText.react","RollCallPromptType","asyncToGeneratorRuntime","react","useMWXPushToast","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k;e=k||d("react");var l=i||(i=c("react")),m=e.useCallback,n=e.useState,o={previewCard:{minHeight:"xz65tgg",width:"xrostsh",$$css:!0}};function a(a){var e=a.onClose,f=a.threadKey,g=a.threadType,i=(j||(j=c("useReStore")))(),k=d("MWPActor.react").useActor(),p=c("useMWXPushToast")();a=n("");var q=a[0],r=a[1];a=n(!1);var s=a[0],t=a[1];a=function(){b("asyncToGeneratorRuntime").asyncToGenerator(function*(){t(!0);var a=(yield d("MWPromptCreationUtils").createAuthoritiativeRollCall(i,f,q,c("RollCallPromptType").TEXT));yield d("MWPromptCreationUtils").createOptimisticRollCallMessage(i,k,f,g,a,q,c("RollCallPromptType").TEXT);e()})()["catch"](function(a){t(!1),c("FBLogger")("messenger_web_messaging").catching(a).mustfix("Creating prompt"),p({body:h._("__JHASH___58Ig9CWslh__JHASH__")})})};var u=m(function(a){r(a.toString())},[]),v=m(function(a){return a==="textarea"},[]);return l.jsx(c("MWXDialog.react"),{footer:l.jsx(c("MWXDialogFooter.react"),{callToActionGroupDirection:"backward",primaryCallToAction:{disabled:s||q.trim()==="",label:h._("__JHASH__racSmevYoYZ__JHASH__"),onPress:a},secondaryCallToAction:{label:h._("__JHASH__ddF1YsNwDg4__JHASH__"),onPress:e}}),header:l.jsx(c("MWXDialogHeader.react"),{onClose:e,title:h._("__JHASH__ALK-qDDamkT__JHASH__"),withCloseButton:!0}),onClose:e,size:"small",children:l.jsx(d("FocusRegion.react").FocusRegion,{autoFocusQuery:v,children:l.jsxs("div",{className:"x6s0dn4 x9f619 x78zum5 xdt5ytf",children:[l.jsx("div",{className:"x1y1aw1k x1n2onr6",children:l.jsx(c("MWChatPromptFlyoutFrontCard.react"),{onChange:function(a){r(a.target.value)},showFacepile:!1,value:q,xstyle:o.previewCard})}),l.jsx(c("MWChatPromptFlyoutSuggestions.react"),{onPressSuggestion:u}),l.jsx("div",{className:"xyamay9 x2b8uid",children:l.jsx(c("MWXText.react"),{type:"meta4",children:h._("__JHASH__5IH2ZuZJVHE__JHASH__")})})]})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);