;/*FB_PKG_DELIM*/

__d("MWMediaComposerLinkPreviewXMARenderQpl",["I64","LSIntEnum","MAWQPLInstanceKeyUtils","MWMediaRenderQplUtils","MessagingAttachmentType","QPLUserFlow","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;b=h||d("react");var k=b.useEffect,l=b.useMemo,m=b.useRef;function a(a,b,e,f){a===void 0&&(a="");b===void 0&&(b="");var g=d("MAWQPLInstanceKeyUtils").getInstanceKey(a.concat(b)),h=m(!1),n=l(function(){if(a==null||b==null)return null;var k=(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA);c("QPLUserFlow").start(d("MWMediaRenderQplUtils").event,{annotations:{string:{attachment_type:d("MWMediaRenderQplUtils").getAttachmentTypeStringFromEnum(k),content_type:d("MWMediaRenderQplUtils").deriveMessageContentTypeStringFromAttachmentTypeLessAccurate(k),entry_point:"composer_view",linkPreviewDataType:d("MWMediaRenderQplUtils").getE2EELinkPreviewXMADataTypeStringFromEnum((k=e)!=null?k:(j||(j=d("I64"))).zero),thread_type:d("MWMediaRenderQplUtils").getThreadTypeStringFromEnum((k=f)!=null?k:(j||(j=d("I64"))).zero)}},cancelOnUnload:!0,instanceKey:g,timeoutInMs:d("MWMediaRenderQplUtils").QPL_TIMEOUT});h.current=!1;return babelHelpers["extends"]({},d("MWMediaRenderQplUtils").createQplFlowCommon(d("MWMediaRenderQplUtils").event,g,h))},[g]);k(function(){return function(){h.current===!1&&(n==null?void 0:n.getInstanceKey())!=null&&(n==null?void 0:n.endCancel(706))}},[n]);return n}g.useMediaComposerLinkPreviewXMARenderQpl=a}),98);
__d("MWXLinkPreviewLoadingIndicator.react",["MWXGlimmer.react","MWXIconLink","MWXIconStrict.react","MWXText.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h,k={glimmer:{borderTopStartRadius:"x1lq5wgf",borderTopEndRadius:"xgqcy7u",borderBottomEndRadius:"x30kzoy",borderBottomStartRadius:"x9jhf4c",height:"xng8ra",width:"xh8yej3",$$css:!0}};function a(a){var b=i(5);a=a.title;if(a==null)return null;var d,e,f;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(d="x6s0dn4 x1amjocr x78zum5 x1q0g3np x5yr21d xc73u3c x5ib6vp",e=j.jsx(c("MWXIconStrict.react"),{color:"secondary",icon:c("MWXIconLink"),size:16}),f="x1iyjqo2",b[0]=d,b[1]=e,b[2]=f):(d=b[0],e=b[1],f=b[2]);b[3]!==a?(d=j.jsx(c("MWXGlimmer.react"),{index:0,xstyle:k.glimmer,children:j.jsxs("div",{className:d,children:[e,j.jsx("div",{className:f,children:j.jsx(c("MWXText.react"),{type:"body4",children:a})})]})}),b[3]=a,b[4]=d):d=b[4];return d}g["default"]=a}),98);
__d("MWXLinkPreviewTruncateText",[],(function(a,b,c,d,e,f){"use strict";var g={body:100,headline:80,subtext:100},h={body:30,headline:20,subtext:30};function a(a){var b=a.isChatTab,c=a.position;a=a.text;b=b?h:g;b=b[c];if(a==null)return void 0;c=a.replace(/\r?\n|\r/g,"").trim();return c.length<=b?c:Array.from(c).slice(0,b).join("").trim()+"..."}f.truncateText=a}),66);
__d("MAWLinkPreviewCard.react",["fbt","ix","BaseView.react","ConstUriUtils","E2EELinkPreviewXMADataStatus","E2EELinkPreviewXMADataType","I64","MAWLinkPreviewDataStatusUtils","MAWLinkPreviewDataTypeUtils","MWLSThreadDisplayContext","MWMediaComposerLinkPreviewXMARenderQpl","MWXIcon.react","MWXImage.react","MWXLinkPreviewLoadingIndicator.react","MWXLinkPreviewTruncateText","MWXText.react","MWXTextPairing.react","asyncToGeneratorRuntime","fbicon","react","useReStore"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k,l,m=l||(l=d("react"));e=l;var n=e.useCallback,o=e.useEffect,p={container:{alignItems:"x6s0dn4",display:"x78zum5",justifyContent:"x1qughib",$$css:!0},content:{alignItems:"x6s0dn4",display:"x78zum5",justifyContent:"xlqzeqv",width:"xh8yej3",$$css:!0},image:{borderTopStartRadius:"x1lcm9me",borderTopEndRadius:"x1yr5g0i",borderBottomEndRadius:"xrt01vj",borderBottomStartRadius:"x10y3i5r",height:"xng8ra",marginEnd:"xmo9yow",objectFit:"xl1xv1r",width:"x1247r65",$$css:!0},isReplying:{borderTopWidth:"x972fbf",$$css:!0},outerContainer:{backgroundColor:"x57kliw",borderTopColor:"x8cjs6t",borderTopStyle:"x13fuv20",borderTopWidth:"x178xt8z",paddingStart:"xvpee5o",paddingLeft:null,paddingRight:null,paddingEnd:"x14uny0o",paddingTop:"x889kno",$$css:!0},textSection:{flexShrink:"xs83m0k",minWidth:"xeuugli",$$css:!0}};function a(a){var e,g=a.draftID,l=a.isReplying,q=a.linkPreview,r=a.threadType;a=a.xmaData;var s=d("MWMediaComposerLinkPreviewXMARenderQpl").useMediaComposerLinkPreviewXMARenderQpl(g,a.url,q.dataType,r),t=(j||(j=c("useReStore")))();g=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext()==="ChatTab";r=d("MAWLinkPreviewDataTypeUtils").linkPreviewDataTypeIsOfType(q.dataType,c("E2EELinkPreviewXMADataType").FALLBACK);var u=a.author_name,v=a.iframeMediaURL,w=a.title,x=a.url;e=x!=null?(e=d("ConstUriUtils").getUri(x))==null?void 0:e.getDomain():"";x=d("MWXLinkPreviewTruncateText").truncateText({isChatTab:g,position:"subtext",text:r?x:e});e=d("MWXLinkPreviewTruncateText").truncateText({isChatTab:g,position:"headline",text:r?void 0:w});g=d("MWXLinkPreviewTruncateText").truncateText({isChatTab:g,position:"body",text:r?w:u});var y=d("MAWLinkPreviewDataStatusUtils").linkPreviewDataStatusIsOfType(q==null?void 0:q.status,c("E2EELinkPreviewXMADataStatus").LOADING);o(function(){!Boolean(v)&&!y?s==null?void 0:s.endSuccess({bool:{has_media_preview_url:!1}}):s==null?void 0:s.addPoint("link-preview-card-render")},[v,y,s]);r=n(function(){s==null?void 0:s.endFail("load-image-error")},[s]);w=n(function(){s==null?void 0:s.endSuccess({bool:{has_media_preview_url:!0}})},[s]);if(y){s==null?void 0:s.addPoint("render_preview_loading_indicator");return m.jsx(c("BaseView.react"),{xstyle:[p.outerContainer,l&&p.isReplying],children:m.jsx(c("BaseView.react"),{xstyle:p.container,children:m.jsx(c("MWXLinkPreviewLoadingIndicator.react"),{title:a.title})})})}return m.jsx(c("BaseView.react"),{xstyle:[p.outerContainer,l&&p.isReplying],children:m.jsxs(c("BaseView.react"),{xstyle:p.container,children:[m.jsxs(c("BaseView.react"),{xstyle:p.content,children:[v!=null&&m.jsx(c("MWXImage.react"),{onError:r,onLoad:w,src:v,xstyle:p.image}),m.jsx(c("BaseView.react"),{xstyle:p.textSection,children:m.jsx(c("MWXTextPairing.react"),{body:g,bodyLineLimit:1,headline:m.jsx(c("MWXText.react"),{type:"headline4",children:e}),level:4,meta:x})})]}),m.jsx(c("MWXIcon.react"),{"aria-label":h._("__JHASH__bIolCKyk1Ph__JHASH__"),color:"primary",icon:d("fbicon")._(i("478231"),12),onPress:function(){void t.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield a.e2ee_composer_draft_link_preview.put({data:(a=q.data)!=null?a:void 0,dataType:(a=q.dataType)!=null?a:void 0,draftId:q.draftId,status:(k||(k=d("I64"))).of_int32(c("E2EELinkPreviewXMADataStatus").DISABLED)})});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":185")}})]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("MAWLinkPreview.react",["MAWLinkPreviewCard.react","MAWParseLinkPreviewXMAData","MWPComposerDraftMessages","ReQL","ReQLSuspense","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react");function a(a){var b=a.isReplying,e=a.threadKey;a=a.threadType;var g=(h||(h=c("useReStore")))(),i=(e=d("MWPComposerDraftMessages").getDraftMessage(e))==null?void 0:e.id;e=d("ReQLSuspense").useFirst(function(){var a;return d("ReQL").fromTableAscending(g.tables.e2ee_composer_draft_link_preview).getKeyRange((a=i)!=null?a:"")},[g.tables.e2ee_composer_draft_link_preview,i],f.id+":36");var k=d("MAWParseLinkPreviewXMAData").parseLinkPreviewXMAData(e);return(e==null?void 0:e.draftId)==null||k==null?null:j.jsx(c("MAWLinkPreviewCard.react"),{draftID:e==null?void 0:e.draftId,isReplying:b,linkPreview:e,threadType:a,xmaData:k})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWXRelayComposerLinkPreviewXMAHeaderCard_draftLinkPreview.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:{hasClientEdges:!0,throwOnFieldError:!0},name:"MWXRelayComposerLinkPreviewXMAHeaderCard_draftLinkPreview",selections:[{alias:null,args:null,kind:"ScalarField",name:"data",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},{alias:"draftId",args:null,kind:"ScalarField",name:"draft_id",storageKey:null},{alias:"dataType",args:null,kind:"ScalarField",name:"data_type",storageKey:null},{kind:"RequiredField",field:{alias:null,args:null,concreteType:"LS_XMA_Link_Preview",kind:"LinkedField",name:"xma",plural:!1,selections:[{alias:"authorName",args:null,kind:"ScalarField",name:"author_name",storageKey:null},{alias:"iframeMediaURL",args:null,kind:"ScalarField",name:"iframe_media_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:null},action:"THROW",path:"xma"}],type:"LS_E2eeComposerDraftLinkPreview",abstractKey:null};e.exports=a}),null);
__d("MWXRelayComposerLinkPreviewXMAHeaderCard.react",["fbt","ConstUriUtils","E2EELinkPreviewXMADataStatus","E2EELinkPreviewXMADataType","I64","LSRelayHooks","MAWLinkPreviewDataStatusUtils","MAWLinkPreviewDataTypeUtils","MWLSThreadDisplayContext","MWMediaComposerLinkPreviewXMARenderQpl","MWXComposer.react","MWXIconCross","MWXImage.react","MWXLinkPreviewLoadingIndicator.react","MWXLinkPreviewTruncateText","MWXRelayComposerLinkPreviewXMAHeaderCard_draftLinkPreview.graphql","asyncToGeneratorRuntime","react","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=l||(l=d("react"));e=l;e.useCallback;var n=e.useEffect,o=e.c,p={image:{borderTopStartRadius:"x1lcm9me",borderTopEndRadius:"x1yr5g0i",borderBottomEndRadius:"xrt01vj",borderBottomStartRadius:"x10y3i5r",height:"xng8ra",marginEnd:"xmo9yow",objectFit:"xl1xv1r",width:"x1247r65",$$css:!0}},q=i!==void 0?i:i=b("MWXRelayComposerLinkPreviewXMAHeaderCard_draftLinkPreview.graphql");function a(a){var e,g=o(42),i=a.draftLinkPreview;a=a.threadType;var l=d("LSRelayHooks").useFragment(q,i);i=l.xma;var r=d("MWMediaComposerLinkPreviewXMARenderQpl").useMediaComposerLinkPreviewXMARenderQpl(l.draftId,(e=i==null?void 0:i.url)!=null?e:void 0,l.dataType,a);e=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext()==="ChatTab";var s=(j||(j=c("useReStore")))();a=d("MAWLinkPreviewDataTypeUtils").linkPreviewDataTypeIsOfType(l.dataType,c("E2EELinkPreviewXMADataType").FALLBACK);var t=i.authorName,u=i.iframeMediaURL,v=i.title,w=i.url;if(g[0]!==w){var x;x=w!=null?(x=d("ConstUriUtils").getUri(w))==null?void 0:x.getDomain():"";g[0]=w;g[1]=x}else x=g[1];x=x;w=a?w:x;g[2]!==e||g[3]!==w?(x=d("MWXLinkPreviewTruncateText").truncateText({isChatTab:e,position:"subtext",text:w}),g[2]=e,g[3]=w,g[4]=x):x=g[4];w=x;x=a?void 0:v;var y;g[5]!==e||g[6]!==x?(y=d("MWXLinkPreviewTruncateText").truncateText({isChatTab:e,position:"headline",text:x}),g[5]=e,g[6]=x,g[7]=y):y=g[7];x=y;y=a?v:t;g[8]!==e||g[9]!==y?(a=d("MWXLinkPreviewTruncateText").truncateText({isChatTab:e,position:"body",text:y}),g[8]=e,g[9]=y,g[10]=a):a=g[10];v=a;t=l==null?void 0:l.status;g[11]!==t?(e=d("MAWLinkPreviewDataStatusUtils").linkPreviewDataStatusIsOfType(t,c("E2EELinkPreviewXMADataStatus").LOADING),g[11]=t,g[12]=e):e=g[12];var z=e;g[13]!==u||g[14]!==z||g[15]!==r?(y=function(){!Boolean(u)&&!z?r==null?void 0:r.endSuccess({bool:{has_media_preview_url:!1}}):r==null?void 0:r.addPoint("link-preview-card-render")},a=[u,z,r],g[13]=u,g[14]=z,g[15]=r,g[16]=y,g[17]=a):(y=g[16],a=g[17]);n(y,a);g[18]!==r?(t=function(){r==null?void 0:r.endFail("load-image-error")},g[18]=r,g[19]=t):t=g[19];e=t;g[20]!==r?(y=function(){r==null?void 0:r.endSuccess({bool:{has_media_preview_url:!0}})},g[20]=r,g[21]=y):y=g[21];a=y;y=(t=v)!=null?t:void 0;t=(v=x)!=null?v:void 0;g[22]!==u||g[23]!==e||g[24]!==a?(x=u!=null&&m.jsx(c("MWXImage.react"),{onError:e,onLoad:a,src:u,xstyle:p.image}),g[22]=u,g[23]=e,g[24]=a,g[25]=x):x=g[25];g[26]!==z||g[27]!==i?(v=z?m.jsx(c("MWXLinkPreviewLoadingIndicator.react"),{title:i.title}):null,g[26]=z,g[27]=i,g[28]=v):v=g[28];g[29]===Symbol["for"]("react.memo_cache_sentinel")?(e=h._("__JHASH__bIolCKyk1Ph__JHASH__"),g[29]=e):e=g[29];g[30]!==s||g[31]!==l.data||g[32]!==l.dataType||g[33]!==l.draftId?(a=m.jsx(d("MWXComposer.react").Button,{icon:c("MWXIconCross"),label:e,onPress:function(){s.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield a.e2ee_composer_draft_link_preview.put({data:(a=l.data)!=null?a:void 0,dataType:(a=l.dataType)!=null?a:void 0,draftId:l.draftId,status:(k||(k=d("I64"))).of_int32(c("E2EELinkPreviewXMADataStatus").DISABLED)})});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":159")}}),g[30]=s,g[31]=l.data,g[32]=l.dataType,g[33]=l.draftId,g[34]=a):a=g[34];e=(i=w)!=null?i:"";g[35]!==y||g[36]!==t||g[37]!==x||g[38]!==v||g[39]!==a||g[40]!==e?(w=m.jsx(d("MWXComposer.react").Header,{bodyText:y,"data-testid":void 0,headlineText:t,leftAddon:x,level:4,loadingIndicator:v,rightAddon:a,subtext:e}),g[35]=y,g[36]=t,g[37]=x,g[38]=v,g[39]=a,g[40]=e,g[41]=w):w=g[41];return w}g["default"]=a}),226);
__d("MWXRelayComposerLinkPreviewXMAHeader_thread.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:{hasClientEdges:!0,throwOnFieldError:!0},name:"MWXRelayComposerLinkPreviewXMAHeader_thread",selections:[{kind:"RequiredField",field:{alias:"threadType",args:null,kind:"ScalarField",name:"thread_type",storageKey:null},action:"THROW",path:"threadType"},{alias:"linkPreview",args:null,concreteType:"LS_E2eeComposerDraftLinkPreview",kind:"LinkedField",name:"e2ee_composer_draft_link_preview",plural:!1,selections:[{alias:"draftId",args:null,kind:"ScalarField",name:"draft_id",storageKey:null},{alias:null,args:null,concreteType:"LS_XMA_Link_Preview",kind:"LinkedField",name:"xma",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"MWXRelayComposerLinkPreviewXMAHeaderCard_draftLinkPreview"}],storageKey:null}],type:"LS_Thread",abstractKey:null};e.exports=a}),null);
__d("MWXRelayComposerLinkPreviewXMAHeader.react",["LSRelayHooks","MWXRelayComposerLinkPreviewXMAHeaderCard.react","MWXRelayComposerLinkPreviewXMAHeader_thread.graphql","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(i||(i=d("react"))).c,k=i,l=h!==void 0?h:h=b("MWXRelayComposerLinkPreviewXMAHeader_thread.graphql");function a(a){var b=j(3);a=a.threadKey;a=d("LSRelayHooks").useFragment(l,a);var e=a.linkPreview;a=a.threadType;var f=e==null?void 0:e.xma;if((e==null?void 0:e.draftId)==null||f==null)return null;b[0]!==e||b[1]!==a?(f=k.jsx(c("MWXRelayComposerLinkPreviewXMAHeaderCard.react"),{draftLinkPreview:e,threadType:a}),b[0]=e,b[1]=a,b[2]=f):f=b[2];return f}g["default"]=a}),98);